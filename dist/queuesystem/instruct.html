<!DOCTYPE html><html lang="en" class="transform"><head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.svg">
    <!-- Preload front from google - it is faster than serving it from the Netlify CDN. -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Meta data changed on build -->
    <title>'Nick Graffis'</title>
    <script type="module" crossorigin="" src="/assets/app.3d6c68a9.js"></script>
    <link rel="modulepreload" href="/assets/vendor.09be1bf3.js">
    <style>*,:before,:after{-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb;}*{--tw-ring-inset:var(--tw-empty, );--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59, 130, 246, .5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;}:root{-moz-tab-size:4;-o-tab-size:4;tab-size:4;}a{color:inherit;text-decoration:inherit;}body{margin:0;font-family:inherit;line-height:inherit;}button{font-family:inherit;font-size:100%;line-height:1.15;margin:0;text-transform:none;background-color:transparent;background-image:none;padding:0;line-height:inherit;color:inherit;}button{-webkit-appearance:button;}button{cursor:pointer;}html{-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";line-height:1.5;}h1{font-size:inherit;font-weight:inherit;}pre{font-size:1em;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;}p,h1,pre{margin:0;}svg{display:block;vertical-align:middle;}.prose{color:#374151;max-width:65ch;font-size:1rem;line-height:1.75;}.prose a{color:#111827;text-decoration:underline;font-weight:500;}.prose ol>li{position:relative;padding-left:1.75em;}.prose ol>li:before{content:counter(list-item,var(--list-counter-style, decimal)) ".";position:absolute;font-weight:400;color:#6b7280;left:0;}.prose ul>li{position:relative;padding-left:1.75em;}.prose ul>li:before{content:"";position:absolute;background-color:#d1d5db;border-radius:50%;width:.375em;height:.375em;top:0.6875em;left:.25em;}.prose h1{color:#111827;font-weight:800;font-size:2.25em;margin-top:0;margin-bottom:.8888889em;line-height:1.1111111;}.prose h2{color:#111827;font-weight:700;font-size:1.5em;margin-top:2em;margin-bottom:1em;line-height:1.3333333;}.prose code{color:#111827;font-weight:600;font-size:.875em;}.prose code:before{content:"`";}.prose code:after{content:"`";}.prose pre{color:#e5e7eb;background-color:#1f2937;overflow-x:auto;font-size:.875em;line-height:1.7142857;margin-top:1.7142857em;margin-bottom:1.7142857em;border-radius:.375rem;padding:.8571429em 1.1428571em;}.prose pre code{background-color:transparent;border-width:0;border-radius:0;padding:0;font-weight:400;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit;}.prose pre code:before{content:none;}.prose pre code:after{content:none;}.prose p{margin-top:1.25em;margin-bottom:1.25em;}.prose ol,.prose ul{margin-top:1.25em;margin-bottom:1.25em;list-style-type:none;}.prose li{margin-top:.5em;margin-bottom:.5em;}.prose>ul>li>*:first-child{margin-top:1.25em;}.prose>ul>li>*:last-child{margin-bottom:1.25em;}.prose>ol>li>*:first-child{margin-top:1.25em;}.prose>ol>li>*:last-child{margin-bottom:1.25em;}.prose ul ul{margin-top:.75em;margin-bottom:.75em;}.prose h2+*{margin-top:0;}.prose>:first-child{margin-top:0;}.prose>:last-child{margin-bottom:0;}.prose-sm{font-size:.875rem;line-height:1.7142857;max-width:100%;color:inherit;}.prose-sm p{margin-top:1.1428571em;margin-bottom:1.1428571em;font-size:18px;}.prose-sm h1{font-size:2.1428571em;margin-top:0;margin-bottom:.8em;line-height:1.2;color:inherit;}.prose-sm h2{font-size:1.4285714em;margin-top:1.6em;margin-bottom:.8em;line-height:1.4;color:inherit;}.prose-sm code{font-size:.8571429em;color:inherit;}.prose-sm pre{font-size:18px;line-height:1.6666667;margin-top:1.6666667em;margin-bottom:1.6666667em;border-radius:.25rem;padding:0;}.prose-sm ol,.prose-sm ul{margin-top:1.1428571em;margin-bottom:1.1428571em;}.prose-sm li{margin-top:.2857143em;margin-bottom:.2857143em;}.prose-sm ol>li{padding-left:1.5714286em;}.prose-sm ol>li:before{left:0;}.prose-sm ul>li{padding-left:1.5714286em;}.prose-sm ul>li:before{height:.3571429em;width:.3571429em;top:0.67857em;left:.2142857em;}.prose-sm>ul>li>*:first-child{margin-top:1.1428571em;}.prose-sm>ul>li>*:last-child{margin-bottom:1.1428571em;}.prose-sm>ol>li>*:first-child{margin-top:1.1428571em;}.prose-sm>ol>li>*:last-child{margin-bottom:1.1428571em;}.prose-sm ul ul{margin-top:.5714286em;margin-bottom:.5714286em;}.prose-sm h2+*{margin-top:0;}.prose-sm>:first-child{margin-top:0;}.prose-sm>:last-child{margin-bottom:0;}.prose-sm a{color:inherit;font-weight:500;text-decoration:underline;}.prose-sm a:hover{color:inherit;}.prose-sm em{color:inherit;}@font-face{font-family:Dank Mono;src:url(/assets/DankMono-Bold.d89b0eba.woff2) format("woff2");font-weight:700;font-style:normal;font-display:swap;}@font-face{font-family:Dank Mono;src:url(/assets/DankMono-Italic.1a9414bc.woff2) format("woff2");font-weight:400;font-style:italic;font-display:swap;}@font-face{font-family:Dank Mono;src:url(/assets/DankMono-Regular.2fe2c7c9.woff2) format("woff2");font-weight:400;font-style:normal;font-display:swap;}.heroicon:before{vertical-align:text-top;font-family:heroicons!important;font-style:normal;font-weight:400!important;vertical-align:top;}@font-face{font-family:heroicons;src:url(/assets/heroicons.1c0542d8.eot?#iefix) format("embedded-opentype"),url(/assets/heroicons.831c3bd7.woff) format("woff"),url(/assets/heroicons.1e50c56c.woff2) format("woff2"),url(/assets/heroicons.6ea4c5e7.ttf) format("truetype"),url(/assets/heroicons.11233d2d.svg#heroicons) format("svg");}.heroicon{line-height:1;}.heroicon-duplicate:before{content:"\f125";}:root{--nord0:#2e3440;--nord1:#3b4252;--nord2:#434c5e;--nord3:#4c566a;--nord4:#d8dee9;--nord5:#e5e9f0;--nord6:#eceff4;--nord7:#8fbcbb;--nord8:#88c0d0;--nord9:#81a1c1;--nord10:#5e81ac;--nord11:#bf616a;--nord12:#d08770;--nord13:#ebcb8b;--nord14:#a3be8c;--nord15:#b48ead;}html{--back:#22212C;--middle:#44475a;--front:#6272a4;--primary:#f8f8f2;--secondary:#ffb86c;--tertiary:#9580FF;--rose:#FF7AC6;--corn:#f1fa8c;--grass:#50fa7b;--muted:#6272a4;--highlight-primary:#ffb86c;--highlight-muted:#ffb86c;}pre,.prose code,.shiki{font-family:Dank Mono;font-size:18px;white-space:pre;-webkit-overflow-scrolling:touch;}.prose .markdown-it-code-copy>:first-child{font-size:1.25rem;line-height:1.75rem;opacity:.4;padding:.5rem;--tw-text-opacity:1;color:rgba(255,255,255,var(--tw-text-opacity));}.prose .markdown-it-code-copy>:first-child:hover{opacity:.8;}.code-container .line{--tw-border-opacity:1;border-color:rgba(40,42,54,var(--tw-border-opacity));border-left-width:6px;padding-left:1rem;padding-right:1rem;}.code-container{display:inline-block;padding-top:2.5rem!important;padding-bottom:2.5rem!important;width:100%;-webkit-transition-property:background-color,border-color,color,fill,stroke;-o-transition-property:background-color,border-color,color,fill,stroke;transition-property:background-color,border-color,color,fill,stroke;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);-o-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);-webkit-transition-duration:.15s;-o-transition-duration:.15s;transition-duration:.15s;-webkit-transition-duration:.5s;-o-transition-duration:.5s;transition-duration:.5s;}.code-container::-webkit-scrollbar{display:none;}.language-id{display:none;}.native-emoji{display:none;}a:active{outline:2px solid transparent;outline-offset:2px;}a.header-anchor{float:left;margin-top:.125em;margin-left:-1.2em;padding-right:.5em;font-size:.85em;opacity:0;text-decoration:none;border:0!important;}a.header-anchor:hover,a.header-anchor:focus{text-decoration:none;}h1:hover .header-anchor,h1:focus .header-anchor,h2:hover .header-anchor,h2:focus .header-anchor{opacity:.5;}.prose a:hover{color:var(--secondary);}.prose a{-webkit-transition-property:background-color,border-color,color,fill,stroke;-o-transition-property:background-color,border-color,color,fill,stroke;transition-property:background-color,border-color,color,fill,stroke;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);-o-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);-webkit-transition-duration:.15s;-o-transition-duration:.15s;transition-duration:.15s;-webkit-transition-duration:.3s;-o-transition-duration:.3s;transition-duration:.3s;}.prose ul{font-size:18px;}.prose ol{margin:0;padding:0;font-size:18px;}.prose ol li:before{font-weight:600;color:var(--primary);}.prose h1:focus,.prose h2:focus{outline:2px solid transparent;outline-offset:2px;}.prose-sm>ul>li>*:last-child{margin-bottom:0;}.prose>ul>li>*:last-child{margin-bottom:0;}.prose-sm>ul>li>*:first-child{margin-top:0;}.prose>ul>li>*:first-child{margin-top:0;}html,body,#app{margin:0;padding:0;font-family:Inter;}.space-x-6>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(1.5rem * var(--tw-space-x-reverse));margin-left:calc(1.5rem * calc(1 - var(--tw-space-x-reverse)));}.bg-back{background-color:var(--back);}.hover\:bg-muted:hover{background-color:var(--muted);}.border-blade{--tw-border-opacity:1;border-color:rgba(80,250,123,var(--tw-border-opacity));}.border-muted{border-color:var(--muted);}.border-l-4{border-left-width:4px;}.border-b{border-bottom-width:1px;}.border-r{border-right-width:1px;}.cursor-pointer{cursor:pointer;}.flex{display:-webkit-box;display:-ms-flexbox;display:-webkit-flex;display:flex;}.grid{display:-ms-grid;display:grid;}.flex-col{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;-webkit-flex-direction:column;flex-direction:column;}.items-center{-webkit-box-align:center;-ms-flex-align:center;-webkit-align-items:center;align-items:center;}.justify-center{-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}.justify-between{-webkit-box-pack:justify;-ms-flex-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}.flex-grow{-webkit-box-flex:1;-ms-flex-positive:1;-webkit-flex-grow:1;flex-grow:1;}.flex-shrink-0{-ms-flex-negative:0;-webkit-flex-shrink:0;flex-shrink:0;}.font-bold{font-weight:700;}.font-semibold{font-weight:600;}.h-6{height:1.5rem;}.h-0{height:0px;}.h-full{height:100%;}.h-screen{height:100vh;}.text-sm{font-size:.875rem;line-height:1.25rem;}.text-lg{font-size:1.125rem;line-height:1.75rem;}.\!text-base{font-size:1rem!important;line-height:1.5rem!important;}.m-auto{margin:auto;}.mx-auto{margin-left:auto;margin-right:auto;}.mb-8{margin-bottom:2rem;}.max-w-3xl{max-width:48rem;}.overflow-hidden{overflow:hidden;}.overflow-scroll{overflow:scroll;}.p-4{padding:1rem;}.py-4{padding-top:1rem;padding-bottom:1rem;}.px-4{padding-left:1rem;padding-right:1rem;}.py-6{padding-top:1.5rem;padding-bottom:1.5rem;}.pl-8{padding-left:2rem;}.relative{position:relative;}[fill~=none]{fill:none;}.text-left{text-align:left;}.text-primary{color:var(--primary);}.hover\:text-blade:hover{--tw-text-opacity:1;color:rgba(80,250,123,var(--tw-text-opacity));}.text-nosferatu{--tw-text-opacity:1;color:rgba(34,33,44,var(--tw-text-opacity));}.hover\:text-secondary:hover{color:var(--secondary);}.w-6{width:1.5rem;}.w-full{width:100%;}.z-50{z-index:50;}.grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr));}.col-span-3{-ms-grid-column-span:span 3 / span 3;grid-column:span 3 / span 3;}.col-span-9{-ms-grid-column-span:span 9 / span 9;grid-column:span 9 / span 9;}.transform{--tw-translate-x:0;--tw-translate-y:0;--tw-translate-z:0;--tw-rotate:0;--tw-rotate-x:0;--tw-rotate-y:0;--tw-rotate-z:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-scale-z:1;-webkit-transform:translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) translateZ(var(--tw-translate-z)) rotate(var(--tw-rotate)) rotateX(var(--tw-rotate-x)) rotateY(var(--tw-rotate-y)) rotateZ(var(--tw-rotate-z)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)) scaleZ(var(--tw-scale-z));-ms-transform:translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) translateZ(var(--tw-translate-z)) rotate(var(--tw-rotate)) rotateX(var(--tw-rotate-x)) rotateY(var(--tw-rotate-y)) rotateZ(var(--tw-rotate-z)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)) scaleZ(var(--tw-scale-z));transform:translate(var(--tw-translate-x)) translateY(var(--tw-translate-y)) translateZ(var(--tw-translate-z)) rotate(var(--tw-rotate)) rotateX(var(--tw-rotate-x)) rotateY(var(--tw-rotate-y)) rotate(var(--tw-rotate-z)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)) scaleZ(var(--tw-scale-z));}.-rotate-90{--tw-rotate:-90deg;}.transition-colors{-webkit-transition-property:background-color,border-color,color,fill,stroke;-o-transition-property:background-color,border-color,color,fill,stroke;transition-property:background-color,border-color,color,fill,stroke;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);-o-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);-webkit-transition-duration:.15s;-o-transition-duration:.15s;transition-duration:.15s;}.duration-150{-webkit-transition-duration:.15s;-o-transition-duration:.15s;transition-duration:.15s;}@media (min-width: 1024px){.lg\:text-xl{font-size:1.25rem;line-height:1.75rem;}}</style><link rel="preload" href="/assets/app.918e7b3f.css" as="style">
  <link rel="modulepreload" crossorigin="" href="/assets/INSTRUCT.298f72f4.js"><link rel="modulepreload" crossorigin="" href="/assets/Post.3c6da465.js"><meta name="description" content="Nick Graffis's Personal Website"><meta name="head:count" content="1"><link rel="preload" as="font" crossorigin="anonymous" href="/assets/DankMono-Bold.d89b0eba.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="/assets/DankMono-Italic.1a9414bc.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="/assets/DankMono-Regular.2fe2c7c9.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="/assets/heroicons.1c0542d8.eot?#iefix"></head>
  <body class="text-primary bg-back">
    <div id="app" data-server-rendered="true"><div class="h-screen flex flex-col"><nav class="px-4 m-auto py-6 text-sm z-50 flex items-center justify-between w-full font-semibold text-nosferatu dark:text-cullen border-b border-muted"><a href="/" class="flex items-center justify-center h-full flex-shrink-0"><div class="relative"><svg class="" viewBox="0 0 99 66"><defs><linearGradient id="a" x1=".5" y1="33" x2="65.75" y2="33" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#3b3b3d"></stop><stop offset="1" stop-color="#cfd0d2"></stop></linearGradient><linearGradient id="b" x1="33.25" y1="33" x2="98.5" y2="33" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#396eb5"></stop><stop offset="1" stop-color="#20386c"></stop></linearGradient></defs><path d="M65.75 36A32.76 32.76 0 0 1 .5 36h7.77a25.24 25.24 0 0 0 24.86 22.51A25.26 25.26 0 0 0 58 36zM58 30A25.26 25.26 0 0 0 33.13 7.49 25.24 25.24 0 0 0 8.27 30H.5a32.76 32.76 0 0 1 65.25 0z" style="fill:url(#a);"></path><path d="M41 36a25 25 0 0 0 49.72 0h7.78a32.76 32.76 0 0 1-65.25 0zm-7.76-6a32.76 32.76 0 0 1 65.26 0h-7.77A25 25 0 0 0 41 30z" style="fill:url(#b);"></path></svg></div></a><div class="flex space-x-6 items-center text-lg"><a href="/posts" class="cursor-pointer lg:text-xl !text-base hover:text-secondary transition-colors duration-150"><p>AWS Documentation</p></a><a href="https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/SQS.html" class="cursor-pointer lg:text-xl !text-base hover:text-secondary transition-colors duration-150"><p>AWS Documentation</p></a><a class="cursor-pointer lg:text-xl !text-base hover:text-secondary transition-colors duration-150"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 48 48"><g fill="none"><path d="M24 37c7.18 0 13-5.82 13-13s-5.82-13-13-13s-13 5.82-13 13s5.82 13 13 13z" stroke="currentColor" stroke-width="4" stroke-linejoin="round"></path><path d="M24 6a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M38.5 12a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M44.5 26.5a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M38.5 41a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M24 47a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M9.5 41a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M3.5 26.5a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M9.5 12a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path></g></svg></a></div></nav><div class="grid grid-cols-12 overflow-hidden flex-grow"><div class="col-span-3 overflow-scroll border-r border-muted"><div><!--[--><div class="w-full"><div><!--[--><div class="font-bold p-4 hover:bg-muted flex justify-between"><p>Setup</p><svg xmlns="http://www.w3.org/2000/svg" class="-rotate-90 h-6 w-6 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div><div class="h-0 overflow-hidden"><!--[--><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Give Initial Lambdas Permission</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Create A Queue</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Create A Lambda</div></div><!--]--></div><!--]--></div></div><div class="w-full"><div><!--[--><div class="font-bold p-4 hover:bg-muted flex justify-between"><p>Sending A Message</p><svg xmlns="http://www.w3.org/2000/svg" class="-rotate-90 h-6 w-6 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div><div class="h-0 overflow-hidden"><!--[--><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">The Sqs Sdk</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Our Dynamo Record</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Getting Started</div></div><!--]--></div><!--]--></div></div><div class="w-full"><div><!--[--><div class="font-bold p-4 hover:bg-muted flex justify-between"><p>Queuesystem</p><svg xmlns="http://www.w3.org/2000/svg" class="-rotate-90 h-6 w-6 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div><div class="h-0 overflow-hidden"><!--[--><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Readme</div></div><div class="w-full hover:text-blade"><div class="border-l-4 pl-8 py-4 border-blade">Instruct</div></div><!--]--></div><!--]--></div></div><div class="w-full"><div><!--[--><div class="font-bold p-4 hover:bg-muted flex justify-between"><p>Processing Messages</p><svg xmlns="http://www.w3.org/2000/svg" class="-rotate-90 h-6 w-6 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div><div class="h-0 overflow-hidden"><!--[--><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Processing Tasks Of A Cluster</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Getting Started</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Advanced Features</div></div><!--]--></div><!--]--></div></div><div class="w-full"><div><!--[--><div class="font-bold p-4 hover:bg-muted flex justify-between"><p>Message Clusters</p><svg xmlns="http://www.w3.org/2000/svg" class="-rotate-90 h-6 w-6 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div><div class="h-0 overflow-hidden"><!--[--><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Overview</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Our Global S3 Storage</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Our Dynamo Records</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Createing A Cluster</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Behind The Hood</div></div><!--]--></div><!--]--></div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">What Is Sqs</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Send Many Messages</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Send A Message</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Process A Task</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Process A Message</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted"></div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Create A Queue</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Create A Message Cluster</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Create A Lambda</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">:All(.*)*</div></div><!--]--></div></div><div class="col-span-9 overflow-scroll h-full"><div class="prose prose-sm p-4 text-left mb-8 max-w-3xl mx-auto"><!-- TODO: Why sm? --><!-- Only show if there is a title or display included in the frontmatter --><!----><!-- Only show if there is a date && duration inside the frontmatter --><!----><!--[--><div class="prose prose-sm text-left max-w-3xl mx-auto"><h2 id="functions-for-queue-system" tabindex="-1"><a class="header-anchor" href="#functions-for-queue-system" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">Functions for queue system</span> Functions for queue system </span></h2><ul><li><code>sendMessage</code><span class="emoji-wrapper"><span class="native-emoji">: Send a single message to the queue and create a message record to track the message.</span> : Send a single message to the queue and create a message record to track the message. </span></li><li><code>sendMessageBatch</code><span class="emoji-wrapper"><span class="native-emoji">: Send a batch of messages (max 10) to the queue and create a message record to track each message.</span> : Send a batch of messages (max 10) to the queue and create a message record to track each message. </span></li><li><code>getMessageRecords</code><span class="emoji-wrapper"><span class="native-emoji">: Get the message record for a message. Optionally pass consistent read to ensure the message record is not modified by another process.</span> : Get the message record for a message. Optionally pass consistent read to ensure the message record is not modified by another process. </span></li><li><code>getMessageRecords</code><span class="emoji-wrapper"><span class="native-emoji">: Get many message records. Cannot pass consistent read.</span> : Get many message records. Cannot pass consistent read. </span></li><li><code>getMessageCluster</code><span class="emoji-wrapper"><span class="native-emoji">: Get the record for a batch of connected messages (called a message cluster). Optionally pass consistent read to ensure the message record is not modified by another process.</span> : Get the record for a batch of connected messages (called a message cluster). Optionally pass consistent read to ensure the message record is not modified by another process. </span></li><li><code>getMessageClusterGlobals</code><span class="emoji-wrapper"><span class="native-emoji">: Get the global variables for a batch of connected messages (called a message cluster).</span> : Get the global variables for a batch of connected messages (called a message cluster). </span></li><li><code>isComplete</code><span class="emoji-wrapper"><span class="native-emoji">: Check if a message is complete.</span> : Check if a message is complete. </span></li><li><code>markeComplete</code><span class="emoji-wrapper"><span class="native-emoji">: Mark a message as complete.</span> : Mark a message as complete. </span></li><li><code>updateMessageRecord</code><span class="emoji-wrapper"><span class="native-emoji">: Update a message record.</span> : Update a message record. </span></li><li><code>updateMessageCluster</code><span class="emoji-wrapper"><span class="native-emoji">: Update a message cluter record.</span> : Update a message cluter record. </span></li><li><code>updateMessageClusterGlobals</code><span class="emoji-wrapper"><span class="native-emoji">: Update a message cluster globals.</span> : Update a message cluster globals. </span></li><li><code>createMessageCluster</code><span class="emoji-wrapper"><span class="native-emoji">: Create a message cluster.</span> : Create a message cluster. </span></li></ul><h2 id="flow-of-a-message-cluster" tabindex="-1"><a class="header-anchor" href="#flow-of-a-message-cluster" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">Flow of a Message Cluster</span> Flow of a Message Cluster </span></h2><ol><li><span class="emoji-wrapper"><span class="native-emoji">From the initial Lambda. Call </span> From the initial Lambda. Call </span><code>createMessageCluster</code><span class="emoji-wrapper"><span class="native-emoji"> to create a message cluster.</span> to create a message cluster. </span></li></ol><ul><li><span class="emoji-wrapper"><span class="native-emoji">Pass the message cluster the following:</span> Pass the message cluster the following: </span><ul><li><code>meta</code><span class="emoji-wrapper"><span class="native-emoji">: </span> : </span><em><span class="emoji-wrapper"><span class="native-emoji">optional</span> optional </span></em><span class="emoji-wrapper"><span class="native-emoji"> The meta data for the message cluster. A small piece of data stored in dynamo</span> The meta data for the message cluster. A small piece of data stored in dynamo </span></li><li><code>globals</code><span class="emoji-wrapper"><span class="native-emoji">: </span> : </span><em><span class="emoji-wrapper"><span class="native-emoji">optional</span> optional </span></em><span class="emoji-wrapper"><span class="native-emoji"> A large piece of data stored in s3. Can updated at any time</span> A large piece of data stored in s3. Can updated at any time </span></li><li><code>url</code><span class="emoji-wrapper"><span class="native-emoji">: </span> : </span><em><span class="emoji-wrapper"><span class="native-emoji">required</span> required </span></em><span class="emoji-wrapper"><span class="native-emoji"> The url of the queue</span> The url of the queue </span></li><li><code>tasks</code><span class="emoji-wrapper"><span class="native-emoji">: </span> : </span><em><span class="emoji-wrapper"><span class="native-emoji">required</span> required </span></em><span class="emoji-wrapper"><span class="native-emoji"> Each task is any object that is an explicit set of instructions for a message to perform. This is passed in the body of each message under the key </span> Each task is any object that is an explicit set of instructions for a message to perform. This is passed in the body of each message under the key </span><code>task</code><span class="emoji-wrapper"><span class="native-emoji"> and is stored inside the message record on dynamo, and stored inside each </span> and is stored inside the message record on dynamo, and stored inside each </span><code>task</code><span class="emoji-wrapper"><span class="native-emoji"> of the message cluster record.</span> of the message cluster record. </span></li><li><code>&lt;TaskMeta&gt;</code><span class="emoji-wrapper"><span class="native-emoji">: </span> : </span><em><span class="emoji-wrapper"><span class="native-emoji">typescript</span> typescript </span></em><span class="emoji-wrapper"><span class="native-emoji"> You can pass in the type of each task.</span> You can pass in the type of each task. </span></li><li><code>&lt;Globals&gt;</code><span class="emoji-wrapper"><span class="native-emoji">: </span> : </span><em><span class="emoji-wrapper"><span class="native-emoji">typescript</span> typescript </span></em><span class="emoji-wrapper"><span class="native-emoji"> You can pass in the type of your global store.</span> You can pass in the type of your global store. </span></li><li><code>&lt;Meta&gt;</code><span class="emoji-wrapper"><span class="native-emoji">: </span> : </span><em><span class="emoji-wrapper"><span class="native-emoji">typescript</span> typescript </span></em><span class="emoji-wrapper"><span class="native-emoji"> You can pass in the type of your meta data.</span> You can pass in the type of your meta data. </span></li></ul></li><li><span class="emoji-wrapper"><span class="native-emoji">The </span> The </span><code>createMessageCluster</code><span class="emoji-wrapper"><span class="native-emoji"> function then sets up the following for you:</span> function then sets up the following for you: </span><ul><li><span class="emoji-wrapper"><span class="native-emoji">It creates a global store in s3 with the name of </span> It creates a global store in s3 with the name of </span><code>SQSMESSAGE<div id="app"></div>lt;uuid&gt;-globals.json</code><span class="emoji-wrapper"><span class="native-emoji">. This is where you can store any data that is needed to be shared between all messages in the cluster.</span> . This is where you can store any data that is needed to be shared between all messages in the cluster. </span></li><li><span class="emoji-wrapper"><span class="native-emoji">It creates a message cluster record in dynamo with the pKey of </span> It creates a message cluster record in dynamo with the pKey of </span><code>SQSMESSAGE<div id="app"></div>lt;uuid&gt;</code><span class="emoji-wrapper"><span class="native-emoji"> and the rKey of </span> and the rKey of </span><code>SQSMESSAGE&lt;url&gt;</code><span class="emoji-wrapper"><span class="native-emoji">. This keeps track of the messages in the cluster.</span> . This keeps track of the messages in the cluster. </span></li><li><span class="emoji-wrapper"><span class="native-emoji">It sends of batches of messages to the queue.</span> It sends of batches of messages to the queue. </span></li><li><span class="emoji-wrapper"><span class="native-emoji">It creates a message record in dynamo for each task (message) in the cluster.</span> It creates a message record in dynamo for each task (message) in the cluster. </span></li></ul></li></ul><ol start="2"><li><span class="emoji-wrapper"><span class="native-emoji">From the lambda that gets triggered by the poller poling messages from the queue:</span> From the lambda that gets triggered by the poller poling messages from the queue: </span></li></ol><ul><li><span class="emoji-wrapper"><span class="native-emoji">You have to check if the message </span> You have to check if the message </span><code>isComplete(record)</code><span class="emoji-wrapper"><span class="native-emoji"> and if it returns true you can just return null.</span> and if it returns true you can just return null. </span></li><li><span class="emoji-wrapper"><span class="native-emoji">If the message is not complete, you can begin processing it.</span> If the message is not complete, you can begin processing it. </span></li><li><span class="emoji-wrapper"><span class="native-emoji">You will probably start by using </span> You will probably start by using </span><code>readSQSRecord(record)</code><span class="emoji-wrapper"><span class="native-emoji"> to get the message record.</span> to get the message record. </span><ul><li><span class="emoji-wrapper"><span class="native-emoji">It returns to you the following:</span> It returns to you the following: </span></li></ul></li></ul><div style="position:relative;"><pre class="shiki dracula" style="background-color:#282A36;color:#F8F8F2;"><div class="language-id">ts</div><code class="code-container"><div class="line"><span style="color:#FF79C6;" class="[object Object]">type</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">Response</span><span style="color:#F8F8F2;" class="[object Object]">&lt;</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Meta</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">any</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">, </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Globals</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">any</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">, </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Body</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">any</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">&gt; </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> {</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  url</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">string</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  pKey</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">SQSMessageKey</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  rKey</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">SQSMessageKey</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  task</span><span style="color:#FF79C6;" class="[object Object],[object Object]">?:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">string</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  id</span><span style="color:#FF79C6;" class="[object Object],[object Object]">?:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">string</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  body</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">Body</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  type</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">RecordType</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#50FA7B;" class="[object Object]">getMessageCluster</span><span style="color:#FF79C6;" class="[object Object],[object Object]">?:</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> (</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">consistentRead</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">boolean</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">) </span><span style="color:#FF79C6;" class="[object Object]">=&gt;</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">Promise</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object]">&lt;{ record</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">MessageClusterRecord</span><span style="color:#F8F8F2;" class="[object Object]">&lt;</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Meta</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]">&gt;, </span><span style="color:#50FA7B;" class="[object Object]">getGlobals</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object]"> () </span><span style="color:#FF79C6;" class="[object Object]">=&gt;</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Promise</span><span style="color:#F8F8F2;" class="[object Object]">&lt;</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Globals</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object],[object Object]">&gt; }&gt;,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#50FA7B;" class="[object Object]">getMessageRecord</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> (</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">consistentRead</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">boolean</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">) </span><span style="color:#FF79C6;" class="[object Object]">=&gt;</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">Promise</span><span style="color:#F8F8F2;" class="[object Object]">&lt;</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">MessageRecord</span><span style="color:#F8F8F2;" class="[object Object]">&lt;</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Meta</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]">&gt;&gt;,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">}</span></div></code></pre><button class="markdown-it-code-copy" data-clipboard-text="
	type Response<Meta = any, Globals = any, Body = any> = {
  url: string,
  pKey: SQSMessageKey,
  rKey: SQSMessageKey,
  task?: string,
  id?: string,
  body: Body,
  type: RecordType,
  getMessageCluster?: (consistentRead: boolean) => Promise<{ record: MessageClusterRecord<Meta>, getGlobals: () => Promise<Globals> }>,
  getMessageRecord: (consistentRead: boolean) => Promise<MessageRecord<Meta>>,
}
" style="position:absolute;top:7.5px;right:6px;cursor:pointer;outline:none;" title="Copy"><span style="" class="heroicon heroicon-duplicate"></span></button></div><div style="position:relative;"><pre><code>* You get the url, the pKey (if the message is part of a cluster), the rKey (if the message is part of a cluster), the task (if the message is part of a cluster), the id of the message will always be returned. The body of the message will always be returned. And the type of the message will always be returned.
* You can use the `getMessageRecord` function to get the message record. The use of this would be to gain access to the meta data.
* You can use the `getMessageCluster` function to get the message cluster record. The use of this would be to gain access to the meta data, or the incomplete tasks, and complete tasks.
* You can use `getGlobals` to get the global store for this cluster.
</code></pre><button class="markdown-it-code-copy" data-clipboard-text="
	* You get the url, the pKey (if the message is part of a cluster), the rKey (if the message is part of a cluster), the task (if the message is part of a cluster), the id of the message will always be returned. The body of the message will always be returned. And the type of the message will always be returned.
* You can use the `getMessageRecord` function to get the message record. The use of this would be to gain access to the meta data.
* You can use the `getMessageCluster` function to get the message cluster record. The use of this would be to gain access to the meta data, or the incomplete tasks, and complete tasks.
* You can use `getGlobals` to get the global store for this cluster.
" style="position:absolute;top:7.5px;right:6px;cursor:pointer;outline:none;" title="Copy"><span style="" class="heroicon heroicon-duplicate"></span></button></div><ul><li><span class="emoji-wrapper"><span class="native-emoji">When you are done processing a record call </span> When you are done processing a record call </span><code>markComplete(record)</code><span class="emoji-wrapper"><span class="native-emoji"> to mark the message as complete in both the message record and the message cluster record.</span> to mark the message as complete in both the message record and the message cluster record. </span></li></ul><h1 id="sending-a-simple-message" tabindex="-1"><a class="header-anchor" href="#sending-a-simple-message" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">Sending a simple message</span> Sending a simple message </span></h1><ol><li><p><span class="emoji-wrapper"><span class="native-emoji">Call </span> Call </span><code>sendMessage&lt;Meta&gt;(params: SendMessageRequest, meta?: Meta)</code><span class="emoji-wrapper"><span class="native-emoji"> which resolves into the </span> which resolves into the </span><code>{ pKey: string, rKey: string }</code><span class="emoji-wrapper"><span class="native-emoji"> of the message record. Before it resolves it sends the message to the queue. Meta is some optional data that is stored on the dynamo record, but not on the message body.</span> of the message record. Before it resolves it sends the message to the queue. Meta is some optional data that is stored on the dynamo record, but not on the message body. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">When you get the message call </span> When you get the message call </span><code>isComplete(record)</code><span class="emoji-wrapper"><span class="native-emoji"> to check if the message is complete.</span> to check if the message is complete. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">If the message is not complete you can begin processing it.</span> If the message is not complete you can begin processing it. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">Call </span> Call </span><code>readSQSRecord(record)</code><span class="emoji-wrapper"><span class="native-emoji"> to parse some data from the message, like the body. You can also use the returned </span> to parse some data from the message, like the body. You can also use the returned </span><code>getMessageRecord()</code><span class="emoji-wrapper"><span class="native-emoji"> function to get the message record async.</span> function to get the message record async. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">When you are done processing a record call </span> When you are done processing a record call </span><code>markComplete(record)</code><span class="emoji-wrapper"><span class="native-emoji"> to mark the message as complete.</span> to mark the message as complete. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">What happens to the message record? It is deleted immediately.</span> What happens to the message record? It is deleted immediately. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">What happens if there is an error? It is not deleted and sent back to the queue, if it passes the retry limit it is deleted from the queue, but the message record stays for 30 days.</span> What happens if there is an error? It is not deleted and sent back to the queue, if it passes the retry limit it is deleted from the queue, but the message record stays for 30 days. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">What if I am allowing for batches of records? You can use the </span> What if I am allowing for batches of records? You can use the </span><code>safeProcessBatch(event: SQSEvent, processRecord: (record: SQSRecord) =&gt; Promise&lt;void&gt;)</code><span class="emoji-wrapper"><span class="native-emoji"> function to process a batch of records. In this case the message record is deleted and the message is delted from the queue if it is processed without an error, but if it fails to process it is not deleted from the queue or dynamo and it can be safely reporcessed.</span> function to process a batch of records. In this case the message record is deleted and the message is delted from the queue if it is processed without an error, but if it fails to process it is not deleted from the queue or dynamo and it can be safely reporcessed. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">You can do the same thing with a batch of messages with </span> You can do the same thing with a batch of messages with </span><code>sendMessageBatch&lt;Meta&gt;(params: SendMessageBatchRequest, meta?: Meta)</code><span class="emoji-wrapper"><span class="native-emoji">. The meta data in this case is stored on each message record.</span> . The meta data in this case is stored on each message record. </span></p></li></ol><h1 id="sending-a-message-cluster" tabindex="-1"><a class="header-anchor" href="#sending-a-message-cluster" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">Sending a message cluster</span> Sending a message cluster </span></h1><ol><li><span class="emoji-wrapper"><span class="native-emoji">Create the cluster:</span> Create the cluster: </span></li></ol><div style="position:relative;"><pre class="shiki dracula" style="background-color:#282A36;color:#F8F8F2;"><div class="language-id">ts</div><code class="code-container"><div class="line"><span style="color:#FF79C6;" class="[object Object]">export</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">type</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">MessageClusterParams</span><span style="color:#F8F8F2;" class="[object Object]">&lt;</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Meta</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">any</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">, </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Globals</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">any</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">, </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">TaskMeta</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">any</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">&gt; </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> {</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  url</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">string</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  globals</span><span style="color:#FF79C6;" class="[object Object],[object Object]">?:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">Globals</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  meta</span><span style="color:#FF79C6;" class="[object Object],[object Object]">?:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">Meta</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  tasks</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">TaskMeta</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">[]</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">}</span></div><div class="line"></div><div class="line"><span style="color:#FF79C6;" class="[object Object]">export</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">type</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">MessageClusterBody</span><span style="color:#F8F8F2;" class="[object Object]">&lt;</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">TaskMeta</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">any</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">&gt; </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> {</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  pKey</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">SQSMessageKey</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  rKey</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">SQSMessageKey</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  task</span><span style="color:#FF79C6;" class="[object Object],[object Object]">?:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">TaskMeta</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  type</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">RecordType</span><span style="color:#F8F8F2;" class="[object Object]">.</span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">task</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">}</span></div><div class="line"></div><div class="line"><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">createMessageCluster</span><span style="color:#F8F8F2;" class="[object Object]">&lt;</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Meta</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">, </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Globals</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">, </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">TaskMeta</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object]">&gt;({ </span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object]">  url, </span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object]">  globals, </span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]">  meta,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">  tasks</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">}</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">MessageClusterParams</span><span style="color:#F8F8F2;" class="[object Object]">&lt;</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Meta</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">, </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">Globals</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">, </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">TaskMeta</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">&gt;)</span></div></code></pre><button class="markdown-it-code-copy" data-clipboard-text="
	export type MessageClusterParams<Meta = any, Globals = any, TaskMeta = any> = {
  url: string,
  globals?: Globals,
  meta?: Meta,
  tasks: TaskMeta[]
}

export type MessageClusterBody<TaskMeta = any> = {
  pKey: SQSMessageKey,
  rKey: SQSMessageKey,
  task?: TaskMeta,
  type: RecordType.task
}

createMessageCluster<Meta, Globals, TaskMeta>({ 
  url, 
  globals, 
  meta,
  tasks
}: MessageClusterParams<Meta, Globals, TaskMeta>)
" style="position:absolute;top:7.5px;right:6px;cursor:pointer;outline:none;" title="Copy"><span style="" class="heroicon heroicon-duplicate"></span></button></div><ol start="2"><li><p><span class="emoji-wrapper"><span class="native-emoji">When you recieve the messgae you can process it like other messges:</span> When you recieve the messgae you can process it like other messges: </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">Call </span> Call </span><code>isComplete(record)</code><span class="emoji-wrapper"><span class="native-emoji"> to check if the message is complete.</span> to check if the message is complete. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">If the message is not complete you can begin processing it.</span> If the message is not complete you can begin processing it. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">Call </span> Call </span><code>readSQSRecord(record)</code><span class="emoji-wrapper"><span class="native-emoji"> to parse some data from the message, like the body. You can also use the returned </span> to parse some data from the message, like the body. You can also use the returned </span><code>getMessageRecord()</code><span class="emoji-wrapper"><span class="native-emoji"> function to get the message record async. Or you can use the </span> function to get the message record async. Or you can use the </span><code>getMessageCluster()</code><span class="emoji-wrapper"><span class="native-emoji"> function to get the message cluster record async. Or you can use </span> function to get the message cluster record async. Or you can use </span><code>getGlobals()</code><span class="emoji-wrapper"><span class="native-emoji"> to get the global store for this cluster.</span> to get the global store for this cluster. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">If you need you can update the globals with </span> If you need you can update the globals with </span><code>updateGlobals&lt;Globals&gt;(globals: Globals | (globals: Globals) =&gt; Globals)</code><span class="emoji-wrapper"><span class="native-emoji">. This will update the globals with the new globals.</span> . This will update the globals with the new globals. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">When you are done processing a record call </span> When you are done processing a record call </span><code>markComplete(record)</code><span class="emoji-wrapper"><span class="native-emoji"> to mark the message as complete. This updates the message cluster as well.</span> to mark the message as complete. This updates the message cluster as well. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">If you need to run some logic when the cluster is complete you can use </span> If you need to run some logic when the cluster is complete you can use </span><code>onClusterComplete(key: { pKey: string, rKey: string }, callback: (cluster: MessageCluster&lt;Meta, TaskMeta&gt;, globals) =&gt; Promise&lt;void&gt;)</code><span class="emoji-wrapper"><span class="native-emoji"> to run the logic when the cluster is complete.</span> to run the logic when the cluster is complete. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">What happens to the message records? Message records are deleted immediately. The message cluster record is deleted after 30 days.</span> What happens to the message records? Message records are deleted immediately. The message cluster record is deleted after 30 days. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">What happens to the globals? The globals are avaliable for 30 days.</span> What happens to the globals? The globals are avaliable for 30 days. </span></p></li><li><p><span class="emoji-wrapper"><span class="native-emoji">What happens if there is an error in the cluster? The errored message is not deleted and is sent back to the queue to be retried.</span> What happens if there is an error in the cluster? The errored message is not deleted and is sent back to the queue to be retried. </span></p></li></ol></div><!--]--></div></div></div></div></div>
    
    <script>
      /* Check prefere color scheme **/
      (function() {
        // Current themes are , , 
        document.documentElement.classList.add(
          localStorage.getItem('theme') || '',
        ) // Default theme is dracula
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        const setting = localStorage.getItem('color-schema') || 'auto'
        if (setting === 'dark' || (prefersDark && setting !== 'light'))
          document.documentElement.classList.toggle('dark', true)
      })()
    </script>
  

<link rel="stylesheet" href="/assets/app.918e7b3f.css"></body></html>