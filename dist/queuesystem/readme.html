<!DOCTYPE html><html lang="en" class="transform"><head>
    <meta charset="UTF-8">
    <link rel="icon" href="/favicon.svg">
    <!-- Preload front from google - it is faster than serving it from the Netlify CDN. -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Meta data changed on build -->
    <title>'Nick Graffis'</title>
    <script type="module" crossorigin="" src="/assets/app.3d6c68a9.js"></script>
    <link rel="modulepreload" href="/assets/vendor.09be1bf3.js">
    <style>*,:before,:after{-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb;}*{--tw-ring-inset:var(--tw-empty, );--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59, 130, 246, .5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;}:root{-moz-tab-size:4;-o-tab-size:4;tab-size:4;}a{color:inherit;text-decoration:inherit;}body{margin:0;font-family:inherit;line-height:inherit;}button{font-family:inherit;font-size:100%;line-height:1.15;margin:0;text-transform:none;background-color:transparent;background-image:none;padding:0;line-height:inherit;color:inherit;}button{-webkit-appearance:button;}button{cursor:pointer;}html{-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";line-height:1.5;}h1{font-size:inherit;font-weight:inherit;}pre{font-size:1em;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;}p,h1,pre{margin:0;}svg{display:block;vertical-align:middle;}.prose{color:#374151;max-width:65ch;font-size:1rem;line-height:1.75;}.prose a{color:#111827;text-decoration:underline;font-weight:500;}.prose h1{color:#111827;font-weight:800;font-size:2.25em;margin-top:0;margin-bottom:.8888889em;line-height:1.1111111;}.prose h2{color:#111827;font-weight:700;font-size:1.5em;margin-top:2em;margin-bottom:1em;line-height:1.3333333;}.prose h3{color:#111827;font-weight:600;font-size:1.25em;margin-top:1.6em;margin-bottom:.6em;line-height:1.6;}.prose code{color:#111827;font-weight:600;font-size:.875em;}.prose code:before{content:"`";}.prose code:after{content:"`";}.prose pre{color:#e5e7eb;background-color:#1f2937;overflow-x:auto;font-size:.875em;line-height:1.7142857;margin-top:1.7142857em;margin-bottom:1.7142857em;border-radius:.375rem;padding:.8571429em 1.1428571em;}.prose pre code{background-color:transparent;border-width:0;border-radius:0;padding:0;font-weight:400;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit;}.prose pre code:before{content:none;}.prose pre code:after{content:none;}.prose p{margin-top:1.25em;margin-bottom:1.25em;}.prose h2+*{margin-top:0;}.prose h3+*{margin-top:0;}.prose>:first-child{margin-top:0;}.prose>:last-child{margin-bottom:0;}.prose-sm{font-size:.875rem;line-height:1.7142857;max-width:100%;color:inherit;}.prose-sm p{margin-top:1.1428571em;margin-bottom:1.1428571em;font-size:18px;}.prose-sm h1{font-size:2.1428571em;margin-top:0;margin-bottom:.8em;line-height:1.2;color:inherit;}.prose-sm h2{font-size:1.4285714em;margin-top:1.6em;margin-bottom:.8em;line-height:1.4;color:inherit;}.prose-sm h3{font-size:1.2857143em;margin-top:1.5555556em;margin-bottom:.4444444em;line-height:1.5555556;color:inherit;}.prose-sm code{font-size:.8571429em;color:inherit;}.prose-sm pre{font-size:18px;line-height:1.6666667;margin-top:1.6666667em;margin-bottom:1.6666667em;border-radius:.25rem;padding:0;}.prose-sm h2+*{margin-top:0;}.prose-sm h3+*{margin-top:0;}.prose-sm>:first-child{margin-top:0;}.prose-sm>:last-child{margin-bottom:0;}.prose-sm a{color:inherit;font-weight:500;text-decoration:underline;}.prose-sm a:hover{color:inherit;}.prose-sm em{color:inherit;}@font-face{font-family:Dank Mono;src:url(/assets/DankMono-Bold.d89b0eba.woff2) format("woff2");font-weight:700;font-style:normal;font-display:swap;}@font-face{font-family:Dank Mono;src:url(/assets/DankMono-Italic.1a9414bc.woff2) format("woff2");font-weight:400;font-style:italic;font-display:swap;}@font-face{font-family:Dank Mono;src:url(/assets/DankMono-Regular.2fe2c7c9.woff2) format("woff2");font-weight:400;font-style:normal;font-display:swap;}.heroicon:before{vertical-align:text-top;font-family:heroicons!important;font-style:normal;font-weight:400!important;vertical-align:top;}@font-face{font-family:heroicons;src:url(/assets/heroicons.1c0542d8.eot?#iefix) format("embedded-opentype"),url(/assets/heroicons.831c3bd7.woff) format("woff"),url(/assets/heroicons.1e50c56c.woff2) format("woff2"),url(/assets/heroicons.6ea4c5e7.ttf) format("truetype"),url(/assets/heroicons.11233d2d.svg#heroicons) format("svg");}.heroicon{line-height:1;}.heroicon-duplicate:before{content:"\f125";}:root{--nord0:#2e3440;--nord1:#3b4252;--nord2:#434c5e;--nord3:#4c566a;--nord4:#d8dee9;--nord5:#e5e9f0;--nord6:#eceff4;--nord7:#8fbcbb;--nord8:#88c0d0;--nord9:#81a1c1;--nord10:#5e81ac;--nord11:#bf616a;--nord12:#d08770;--nord13:#ebcb8b;--nord14:#a3be8c;--nord15:#b48ead;}html{--back:#22212C;--middle:#44475a;--front:#6272a4;--primary:#f8f8f2;--secondary:#ffb86c;--tertiary:#9580FF;--rose:#FF7AC6;--corn:#f1fa8c;--grass:#50fa7b;--muted:#6272a4;--highlight-primary:#ffb86c;--highlight-muted:#ffb86c;}pre,.prose code,.shiki{font-family:Dank Mono;font-size:18px;white-space:pre;-webkit-overflow-scrolling:touch;}.prose .markdown-it-code-copy>:first-child{font-size:1.25rem;line-height:1.75rem;opacity:.4;padding:.5rem;--tw-text-opacity:1;color:rgba(255,255,255,var(--tw-text-opacity));}.prose .markdown-it-code-copy>:first-child:hover{opacity:.8;}.code-container .line{--tw-border-opacity:1;border-color:rgba(40,42,54,var(--tw-border-opacity));border-left-width:6px;padding-left:1rem;padding-right:1rem;}.code-container{display:inline-block;padding-top:2.5rem!important;padding-bottom:2.5rem!important;width:100%;-webkit-transition-property:background-color,border-color,color,fill,stroke;-o-transition-property:background-color,border-color,color,fill,stroke;transition-property:background-color,border-color,color,fill,stroke;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);-o-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);-webkit-transition-duration:.15s;-o-transition-duration:.15s;transition-duration:.15s;-webkit-transition-duration:.5s;-o-transition-duration:.5s;transition-duration:.5s;}.code-container::-webkit-scrollbar{display:none;}.language-id{display:none;}.native-emoji{display:none;}a:active{outline:2px solid transparent;outline-offset:2px;}a.header-anchor{float:left;margin-top:.125em;margin-left:-1.2em;padding-right:.5em;font-size:.85em;opacity:0;text-decoration:none;border:0!important;}a.header-anchor:hover,a.header-anchor:focus{text-decoration:none;}h1:hover .header-anchor,h1:focus .header-anchor,h2:hover .header-anchor,h2:focus .header-anchor,h3:hover .header-anchor,h3:focus .header-anchor{opacity:.5;}.prose a:hover{color:var(--secondary);}.prose a{-webkit-transition-property:background-color,border-color,color,fill,stroke;-o-transition-property:background-color,border-color,color,fill,stroke;transition-property:background-color,border-color,color,fill,stroke;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);-o-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);-webkit-transition-duration:.15s;-o-transition-duration:.15s;transition-duration:.15s;-webkit-transition-duration:.3s;-o-transition-duration:.3s;transition-duration:.3s;}.prose h1:focus,.prose h2:focus,.prose h3:focus{outline:2px solid transparent;outline-offset:2px;}html,body,#app{margin:0;padding:0;font-family:Inter;}.space-x-6>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(1.5rem * var(--tw-space-x-reverse));margin-left:calc(1.5rem * calc(1 - var(--tw-space-x-reverse)));}.bg-back{background-color:var(--back);}.hover\:bg-muted:hover{background-color:var(--muted);}.border-blade{--tw-border-opacity:1;border-color:rgba(80,250,123,var(--tw-border-opacity));}.border-muted{border-color:var(--muted);}.border-l-4{border-left-width:4px;}.border-b{border-bottom-width:1px;}.border-r{border-right-width:1px;}.cursor-pointer{cursor:pointer;}.flex{display:-webkit-box;display:-ms-flexbox;display:-webkit-flex;display:flex;}.grid{display:-ms-grid;display:grid;}.flex-col{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;-webkit-flex-direction:column;flex-direction:column;}.items-center{-webkit-box-align:center;-ms-flex-align:center;-webkit-align-items:center;align-items:center;}.justify-center{-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}.justify-between{-webkit-box-pack:justify;-ms-flex-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}.flex-grow{-webkit-box-flex:1;-ms-flex-positive:1;-webkit-flex-grow:1;flex-grow:1;}.flex-shrink-0{-ms-flex-negative:0;-webkit-flex-shrink:0;flex-shrink:0;}.font-bold{font-weight:700;}.font-semibold{font-weight:600;}.h-6{height:1.5rem;}.h-0{height:0px;}.h-full{height:100%;}.h-screen{height:100vh;}.text-sm{font-size:.875rem;line-height:1.25rem;}.text-lg{font-size:1.125rem;line-height:1.75rem;}.\!text-base{font-size:1rem!important;line-height:1.5rem!important;}.m-auto{margin:auto;}.mx-auto{margin-left:auto;margin-right:auto;}.mb-8{margin-bottom:2rem;}.max-w-3xl{max-width:48rem;}.overflow-hidden{overflow:hidden;}.overflow-scroll{overflow:scroll;}.p-4{padding:1rem;}.py-4{padding-top:1rem;padding-bottom:1rem;}.px-4{padding-left:1rem;padding-right:1rem;}.py-6{padding-top:1.5rem;padding-bottom:1.5rem;}.pl-8{padding-left:2rem;}.relative{position:relative;}[fill~=none]{fill:none;}.text-left{text-align:left;}.text-primary{color:var(--primary);}.hover\:text-blade:hover{--tw-text-opacity:1;color:rgba(80,250,123,var(--tw-text-opacity));}.text-nosferatu{--tw-text-opacity:1;color:rgba(34,33,44,var(--tw-text-opacity));}.hover\:text-secondary:hover{color:var(--secondary);}.w-6{width:1.5rem;}.w-full{width:100%;}.z-50{z-index:50;}.grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr));}.col-span-3{-ms-grid-column-span:span 3 / span 3;grid-column:span 3 / span 3;}.col-span-9{-ms-grid-column-span:span 9 / span 9;grid-column:span 9 / span 9;}.transform{--tw-translate-x:0;--tw-translate-y:0;--tw-translate-z:0;--tw-rotate:0;--tw-rotate-x:0;--tw-rotate-y:0;--tw-rotate-z:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-scale-z:1;-webkit-transform:translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) translateZ(var(--tw-translate-z)) rotate(var(--tw-rotate)) rotateX(var(--tw-rotate-x)) rotateY(var(--tw-rotate-y)) rotateZ(var(--tw-rotate-z)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)) scaleZ(var(--tw-scale-z));-ms-transform:translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) translateZ(var(--tw-translate-z)) rotate(var(--tw-rotate)) rotateX(var(--tw-rotate-x)) rotateY(var(--tw-rotate-y)) rotateZ(var(--tw-rotate-z)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)) scaleZ(var(--tw-scale-z));transform:translate(var(--tw-translate-x)) translateY(var(--tw-translate-y)) translateZ(var(--tw-translate-z)) rotate(var(--tw-rotate)) rotateX(var(--tw-rotate-x)) rotateY(var(--tw-rotate-y)) rotate(var(--tw-rotate-z)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)) scaleZ(var(--tw-scale-z));}.-rotate-90{--tw-rotate:-90deg;}.transition-colors{-webkit-transition-property:background-color,border-color,color,fill,stroke;-o-transition-property:background-color,border-color,color,fill,stroke;transition-property:background-color,border-color,color,fill,stroke;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);-o-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);-webkit-transition-duration:.15s;-o-transition-duration:.15s;transition-duration:.15s;}.duration-150{-webkit-transition-duration:.15s;-o-transition-duration:.15s;transition-duration:.15s;}@media (min-width: 1024px){.lg\:text-xl{font-size:1.25rem;line-height:1.75rem;}}</style><link rel="preload" href="/assets/app.918e7b3f.css" as="style">
  <link rel="modulepreload" crossorigin="" href="/assets/README.b6e3c9b6.js"><link rel="modulepreload" crossorigin="" href="/assets/Post.3c6da465.js"><meta name="description" content="Nick Graffis's Personal Website"><meta name="head:count" content="1"><link rel="preload" as="font" crossorigin="anonymous" href="/assets/DankMono-Bold.d89b0eba.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="/assets/DankMono-Italic.1a9414bc.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="/assets/DankMono-Regular.2fe2c7c9.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="/assets/heroicons.1c0542d8.eot?#iefix"></head>
  <body class="text-primary bg-back">
    <div id="app" data-server-rendered="true"><div class="h-screen flex flex-col"><nav class="px-4 m-auto py-6 text-sm z-50 flex items-center justify-between w-full font-semibold text-nosferatu dark:text-cullen border-b border-muted"><a href="/" class="flex items-center justify-center h-full flex-shrink-0"><div class="relative"><svg class="" viewBox="0 0 99 66"><defs><linearGradient id="a" x1=".5" y1="33" x2="65.75" y2="33" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#3b3b3d"></stop><stop offset="1" stop-color="#cfd0d2"></stop></linearGradient><linearGradient id="b" x1="33.25" y1="33" x2="98.5" y2="33" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#396eb5"></stop><stop offset="1" stop-color="#20386c"></stop></linearGradient></defs><path d="M65.75 36A32.76 32.76 0 0 1 .5 36h7.77a25.24 25.24 0 0 0 24.86 22.51A25.26 25.26 0 0 0 58 36zM58 30A25.26 25.26 0 0 0 33.13 7.49 25.24 25.24 0 0 0 8.27 30H.5a32.76 32.76 0 0 1 65.25 0z" style="fill:url(#a);"></path><path d="M41 36a25 25 0 0 0 49.72 0h7.78a32.76 32.76 0 0 1-65.25 0zm-7.76-6a32.76 32.76 0 0 1 65.26 0h-7.77A25 25 0 0 0 41 30z" style="fill:url(#b);"></path></svg></div></a><div class="flex space-x-6 items-center text-lg"><a href="/posts" class="cursor-pointer lg:text-xl !text-base hover:text-secondary transition-colors duration-150"><p>AWS Documentation</p></a><a href="https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/SQS.html" class="cursor-pointer lg:text-xl !text-base hover:text-secondary transition-colors duration-150"><p>AWS Documentation</p></a><a class="cursor-pointer lg:text-xl !text-base hover:text-secondary transition-colors duration-150"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 48 48"><g fill="none"><path d="M24 37c7.18 0 13-5.82 13-13s-5.82-13-13-13s-13 5.82-13 13s5.82 13 13 13z" stroke="currentColor" stroke-width="4" stroke-linejoin="round"></path><path d="M24 6a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M38.5 12a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M44.5 26.5a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M38.5 41a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M24 47a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M9.5 41a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M3.5 26.5a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path><path d="M9.5 12a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5z" fill="currentColor"></path></g></svg></a></div></nav><div class="grid grid-cols-12 overflow-hidden flex-grow"><div class="col-span-3 overflow-scroll border-r border-muted"><div><!--[--><div class="w-full"><div><!--[--><div class="font-bold p-4 hover:bg-muted flex justify-between"><p>Setup</p><svg xmlns="http://www.w3.org/2000/svg" class="-rotate-90 h-6 w-6 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div><div class="h-0 overflow-hidden"><!--[--><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Give Initial Lambdas Permission</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Create A Queue</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Create A Lambda</div></div><!--]--></div><!--]--></div></div><div class="w-full"><div><!--[--><div class="font-bold p-4 hover:bg-muted flex justify-between"><p>Sending A Message</p><svg xmlns="http://www.w3.org/2000/svg" class="-rotate-90 h-6 w-6 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div><div class="h-0 overflow-hidden"><!--[--><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">The Sqs Sdk</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Our Dynamo Record</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Getting Started</div></div><!--]--></div><!--]--></div></div><div class="w-full"><div><!--[--><div class="font-bold p-4 hover:bg-muted flex justify-between"><p>Queuesystem</p><svg xmlns="http://www.w3.org/2000/svg" class="-rotate-90 h-6 w-6 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div><div class="h-0 overflow-hidden"><!--[--><div class="w-full hover:text-blade"><div class="border-l-4 pl-8 py-4 border-blade">Readme</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Instruct</div></div><!--]--></div><!--]--></div></div><div class="w-full"><div><!--[--><div class="font-bold p-4 hover:bg-muted flex justify-between"><p>Processing Messages</p><svg xmlns="http://www.w3.org/2000/svg" class="-rotate-90 h-6 w-6 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div><div class="h-0 overflow-hidden"><!--[--><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Processing Tasks Of A Cluster</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Getting Started</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Advanced Features</div></div><!--]--></div><!--]--></div></div><div class="w-full"><div><!--[--><div class="font-bold p-4 hover:bg-muted flex justify-between"><p>Message Clusters</p><svg xmlns="http://www.w3.org/2000/svg" class="-rotate-90 h-6 w-6 transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div><div class="h-0 overflow-hidden"><!--[--><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Overview</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Our Global S3 Storage</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Our Dynamo Records</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Createing A Cluster</div></div><div class="w-full hover:text-blade"><div class="pl-8 py-4 border-blade">Behind The Hood</div></div><!--]--></div><!--]--></div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">What Is Sqs</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Send Many Messages</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Send A Message</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Process A Task</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Process A Message</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted"></div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Create A Queue</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Create A Message Cluster</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">Create A Lambda</div></div><div class="w-full"><div class="p-4 border-blade hover:bg-muted">:All(.*)*</div></div><!--]--></div></div><div class="col-span-9 overflow-scroll h-full"><div class="prose prose-sm p-4 text-left mb-8 max-w-3xl mx-auto"><!-- TODO: Why sm? --><!-- Only show if there is a title or display included in the frontmatter --><!----><!-- Only show if there is a date && duration inside the frontmatter --><!----><!--[--><div class="prose prose-sm text-left max-w-3xl mx-auto"><h1 id="understanding-simple-queue-service" tabindex="-1"><a class="header-anchor" href="#understanding-simple-queue-service" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">Understanding Simple Queue Service</span> Understanding Simple Queue Service </span></h1><h2 id="queue-configuration" tabindex="-1"><a class="header-anchor" href="#queue-configuration" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">Queue Configuration</span> Queue Configuration </span></h2><h3 id="visibility-timeout" tabindex="-1"><a class="header-anchor" href="#visibility-timeout" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">Visibility Timeout</span> Visibility Timeout </span></h3><p><span class="emoji-wrapper"><span class="native-emoji">Visibility timeout is an extreamly important pramater. It needs to always be greater than the function timeout to avoid duplicate invokes, and for low-concurrency, high-duration functions; we should set visibility timoeut to 6x funciton duration; this will avoid having that receive count move up unnecessarily and keep good messages out of the dead letter queue.</span> Visibility timeout is an extreamly important pramater. It needs to always be greater than the function timeout to avoid duplicate invokes, and for low-concurrency, high-duration functions; we should set visibility timoeut to 6x funciton duration; this will avoid having that receive count move up unnecessarily and keep good messages out of the dead letter queue. </span></p><div style="position:relative;"><pre class="shiki dracula" style="background-color:#282A36;color:#F8F8F2;"><div class="language-id">yaml</div><code class="code-container"><div class="line"><span style="color:#8BE9FD;" class="[object Object],[object Object]">VisibilityTimeout</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#BD93F9;" class="[object Object]">60</span></div></code></pre><button class="markdown-it-code-copy" data-clipboard-text="
	VisibilityTimeout: 60
" style="position:absolute;top:7.5px;right:6px;cursor:pointer;outline:none;" title="Copy"><span style="" class="heroicon heroicon-duplicate"></span></button></div><h3 id="enable-a-redrive-policy" tabindex="-1"><a class="header-anchor" href="#enable-a-redrive-policy" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">Enable a Redrive Policy</span> Enable a Redrive Policy </span></h3><p><span class="emoji-wrapper"><span class="native-emoji">It is extreamly important to enable a redrive policy to catch any messages that are </span> It is extreamly important to enable a redrive policy to catch any messages that are </span><em><span class="emoji-wrapper"><span class="native-emoji">poisen</span> poisen </span></em><span class="emoji-wrapper"><span class="native-emoji">, meaning that they are causing a failure in the function. The </span> , meaning that they are causing a failure in the function. The </span><code>maxReceiveCount</code><span class="emoji-wrapper"><span class="native-emoji"> is the number of times a message will be retried before being moved to the dead letter queue. The </span> is the number of times a message will be retried before being moved to the dead letter queue. The </span><code>deadLetterTargetArn</code><span class="emoji-wrapper"><span class="native-emoji"> is the ARN of the queue that will receive the message.</span> is the ARN of the queue that will receive the message. </span></p><div style="position:relative;"><pre class="shiki dracula" style="background-color:#282A36;color:#F8F8F2;"><div class="language-id">yaml</div><code class="code-container"><div class="line"><span style="color:#8BE9FD;" class="[object Object],[object Object]">RedrivePolicy</span><span style="color:#FF79C6;" class="[object Object]">:</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#8BE9FD;" class="[object Object],[object Object]">deadLetterTargetArn</span><span style="color:#FF79C6;" class="[object Object]">:</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">    </span><span style="color:#8BE9FD;" class="[object Object],[object Object]">Fn::GetAtt</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> [</span><span style="color:#F1FA8C;" class="[object Object],[object Object]">mmDeadLetterQueue</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">, </span><span style="color:#F1FA8C;" class="[object Object],[object Object]">Arn</span><span style="color:#F8F8F2;" class="[object Object]">]</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#8BE9FD;" class="[object Object],[object Object]">maxReceiveCount</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#BD93F9;" class="[object Object]">2</span></div></code></pre><button class="markdown-it-code-copy" data-clipboard-text="
	RedrivePolicy:
  deadLetterTargetArn:
    Fn::GetAtt: [mmDeadLetterQueue, Arn]
  maxReceiveCount: 2
" style="position:absolute;top:7.5px;right:6px;cursor:pointer;outline:none;" title="Copy"><span style="" class="heroicon heroicon-duplicate"></span></button></div><h2 id="function-configuration" tabindex="-1"><a class="header-anchor" href="#function-configuration" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">Function Configuration</span> Function Configuration </span></h2><h3 id="batching" tabindex="-1"><a class="header-anchor" href="#batching" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">Batching</span> Batching </span></h3><p><span class="emoji-wrapper"><span class="native-emoji">It is imporant to enable batching on the lambda that the queue will invoke. This will allow the queue to batch up messages and invoke the function in a single request. The </span> It is imporant to enable batching on the lambda that the queue will invoke. This will allow the queue to batch up messages and invoke the function in a single request. The </span><code>BatchSize</code><span class="emoji-wrapper"><span class="native-emoji"> is the number of batches of messages that will be processed at once, and the </span> is the number of batches of messages that will be processed at once, and the </span><code>MaximumBathchingWindowInSeconds</code><span class="emoji-wrapper"><span class="native-emoji"> is the maximum amount of time that will be spent waiting for new messages to fill the batch before it just begins. This is set to 0 by default.</span> is the maximum amount of time that will be spent waiting for new messages to fill the batch before it just begins. This is set to 0 by default. </span></p><div style="position:relative;"><pre class="shiki dracula" style="background-color:#282A36;color:#F8F8F2;"><div class="language-id">yaml</div><code class="code-container"><div class="line"><span style="color:#8BE9FD;" class="[object Object],[object Object]">BatchSize</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#BD93F9;" class="[object Object]">5</span></div><div class="line"><span style="color:#8BE9FD;" class="[object Object],[object Object]">MaximumBatchingWindowInSeconds</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#BD93F9;" class="[object Object]">1</span></div></code></pre><button class="markdown-it-code-copy" data-clipboard-text="
	BatchSize: 5
MaximumBatchingWindowInSeconds: 1
" style="position:absolute;top:7.5px;right:6px;cursor:pointer;outline:none;" title="Copy"><span style="" class="heroicon heroicon-duplicate"></span></button></div><h3 id="handeling-errors" tabindex="-1"><a class="header-anchor" href="#handeling-errors" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">Handeling Errors</span> Handeling Errors </span></h3><p><span class="emoji-wrapper"><span class="native-emoji">We should handle errors and catch these ourselves. This means that if only one message in a batch is </span> We should handle errors and catch these ourselves. This means that if only one message in a batch is </span><em><span class="emoji-wrapper"><span class="native-emoji">posien</span> posien </span></em><span class="emoji-wrapper"><span class="native-emoji"> then we can manually delete the other messages in that batch that did succeed so they don’t all get retired to the dead letter queue.</span> then we can manually delete the other messages in that batch that did succeed so they don’t all get retired to the dead letter queue. </span></p><p><span class="emoji-wrapper"><span class="native-emoji">And also, manually set the the per-message visibility timeout to a low number on errors so that the retry process will occur quickly and the message can be sent to the dead letter queue.</span> And also, manually set the the per-message visibility timeout to a low number on errors so that the retry process will occur quickly and the message can be sent to the dead letter queue. </span></p><h2 id="what-is-an-sqs-event" tabindex="-1"><a class="header-anchor" href="#what-is-an-sqs-event" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">What is an SQS Event</span> What is an SQS Event </span></h2><p><span class="emoji-wrapper"><span class="native-emoji">The SQS event is a JSON object that contains the details of the event. The top level of this is the </span> The SQS event is a JSON object that contains the details of the event. The top level of this is the </span><code>Records</code><span class="emoji-wrapper"><span class="native-emoji"> array, which contains the details of each message.</span> array, which contains the details of each message. </span></p><div style="position:relative;"><pre class="shiki dracula" style="background-color:#282A36;color:#F8F8F2;"><div class="language-id">json</div><code class="code-container"><div class="line"><span style="color:#F8F8F2;" class="[object Object]">{</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">    </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">Records</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> [</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">        {</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">            </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">messageId</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F1FA8C;" class="[object Object]">059f36b4-87a3-44ab-83d2-661975830a7d</span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">            </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">receiptHandle</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F1FA8C;" class="[object Object]">AQEBwJnKyrHigUMZj6rYigCgxlaS3SLy0a...</span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">            </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">body</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F1FA8C;" class="[object Object]">Test message.</span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">            </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">attributes</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> {</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">                </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">ApproximateReceiveCount</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F1FA8C;" class="[object Object]">1</span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">                </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">SentTimestamp</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F1FA8C;" class="[object Object]">1545082649183</span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">                </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">SenderId</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F1FA8C;" class="[object Object]">AIDAIENQZJOLO23YVJ4VO</span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">                </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">ApproximateFirstReceiveTimestamp</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F1FA8C;" class="[object Object]">1545082649185</span><span style="color:#E9F284;" class="[object Object]">"</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]">            },</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">            </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">messageAttributes</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object]"> {},</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">            </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">md5OfBody</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F1FA8C;" class="[object Object]">e4e68fb7bd0e697a0ae8f1bb342846b3</span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">            </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">eventSource</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F1FA8C;" class="[object Object]">aws:sqs</span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">            </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">eventSourceARN</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F1FA8C;" class="[object Object]">arn:aws:sqs:us-east-2:123456789012:my-queue</span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F8F8F2;" class="[object Object]">,</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">            </span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#8BE9FD;" class="[object Object]">awsRegion</span><span style="color:#8BE9FE;" class="[object Object]">"</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#E9F284;" class="[object Object]">"</span><span style="color:#F1FA8C;" class="[object Object]">us-east-2</span><span style="color:#E9F284;" class="[object Object]">"</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]">        },</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">    ]</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">}</span></div></code></pre><button class="markdown-it-code-copy" data-clipboard-text="
	{
    <DOUBLE-QUOTE>Records<DOUBLE-QUOTE>: [
        {
            <DOUBLE-QUOTE>messageId<DOUBLE-QUOTE>: <DOUBLE-QUOTE>059f36b4-87a3-44ab-83d2-661975830a7d<DOUBLE-QUOTE>,
            <DOUBLE-QUOTE>receiptHandle<DOUBLE-QUOTE>: <DOUBLE-QUOTE>AQEBwJnKyrHigUMZj6rYigCgxlaS3SLy0a...<DOUBLE-QUOTE>,
            <DOUBLE-QUOTE>body<DOUBLE-QUOTE>: <DOUBLE-QUOTE>Test message.<DOUBLE-QUOTE>,
            <DOUBLE-QUOTE>attributes<DOUBLE-QUOTE>: {
                <DOUBLE-QUOTE>ApproximateReceiveCount<DOUBLE-QUOTE>: <DOUBLE-QUOTE>1<DOUBLE-QUOTE>,
                <DOUBLE-QUOTE>SentTimestamp<DOUBLE-QUOTE>: <DOUBLE-QUOTE>1545082649183<DOUBLE-QUOTE>,
                <DOUBLE-QUOTE>SenderId<DOUBLE-QUOTE>: <DOUBLE-QUOTE>AIDAIENQZJOLO23YVJ4VO<DOUBLE-QUOTE>,
                <DOUBLE-QUOTE>ApproximateFirstReceiveTimestamp<DOUBLE-QUOTE>: <DOUBLE-QUOTE>1545082649185<DOUBLE-QUOTE>
            },
            <DOUBLE-QUOTE>messageAttributes<DOUBLE-QUOTE>: {},
            <DOUBLE-QUOTE>md5OfBody<DOUBLE-QUOTE>: <DOUBLE-QUOTE>e4e68fb7bd0e697a0ae8f1bb342846b3<DOUBLE-QUOTE>,
            <DOUBLE-QUOTE>eventSource<DOUBLE-QUOTE>: <DOUBLE-QUOTE>aws:sqs<DOUBLE-QUOTE>,
            <DOUBLE-QUOTE>eventSourceARN<DOUBLE-QUOTE>: <DOUBLE-QUOTE>arn:aws:sqs:us-east-2:123456789012:my-queue<DOUBLE-QUOTE>,
            <DOUBLE-QUOTE>awsRegion<DOUBLE-QUOTE>: <DOUBLE-QUOTE>us-east-2<DOUBLE-QUOTE>
        },
    ]
}
" style="position:absolute;top:7.5px;right:6px;cursor:pointer;outline:none;" title="Copy"><span style="" class="heroicon heroicon-duplicate"></span></button></div><p><span class="emoji-wrapper"><span class="native-emoji">When you are handeling batches of messages, you can use the </span> When you are handeling batches of messages, you can use the </span><code>Records</code><span class="emoji-wrapper"><span class="native-emoji"> array to handle each of these messages. You can then also use the </span> array to handle each of these messages. You can then also use the </span><code>messageId</code><span class="emoji-wrapper"><span class="native-emoji"> to delete the message from the queue if it succeeded and, maybe, some message failed.</span> to delete the message from the queue if it succeeded and, maybe, some message failed. </span></p><p><span class="emoji-wrapper"><span class="native-emoji">Lets see an example of how to potentially handle a batch of messages where some fail.</span> Lets see an example of how to potentially handle a batch of messages where some fail. </span></p><div style="position:relative;"><pre class="shiki dracula" style="background-color:#282A36;color:#F8F8F2;"><div class="language-id">js</div><code class="code-container"><div class="line"><span style="color:#FF79C6;" class="[object Object]">const</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]"> SQS </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;" class="[object Object]">require</span><span style="color:#F8F8F2;" class="[object Object]">(</span><span style="color:#E9F284;" class="[object Object]">'</span><span style="color:#F1FA8C;" class="[object Object]">aws-sdk/clients/sqs</span><span style="color:#E9F284;" class="[object Object]">'</span><span style="color:#F8F8F2;" class="[object Object]">)</span></div><div class="line"><span style="color:#FF79C6;" class="[object Object]">const</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]"> sqs </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;font-weight:bold;" class="[object Object]">new</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#50FA7B;" class="[object Object]">SQS</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">()</span></div><div class="line"></div><div class="line"><span style="color:#FF79C6;" class="[object Object]">async</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">function</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#50FA7B;" class="[object Object]">handler</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> (</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">event</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]">) {</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#FF79C6;" class="[object Object]">const</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]"> messageProcessingPromises </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object],[object Object]"> event.Records.</span><span style="color:#50FA7B;" class="[object Object]">map</span><span style="color:#F8F8F2;" class="[object Object]">(</span><span style="color:#FF79C6;" class="[object Object]">async</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> (</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">record</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">, </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">index</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">) </span><span style="color:#FF79C6;" class="[object Object]">=&gt;</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> {</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">      </span><span style="color:#FF79C6;" class="[object Object]">const</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]"> messageResult </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">await</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#50FA7B;" class="[object Object]">processMessage</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]">(record)</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">      </span><span style="color:#FF79C6;" class="[object Object]">await</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]"> sqs.</span><span style="color:#50FA7B;" class="[object Object]">deleteMessage</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">({</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object]">        QueueUrl</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#50FA7B;" class="[object Object]">getQueueUrl</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object]">({ sqs, eventSourceARN</span><span style="color:#FF79C6;" class="[object Object]">:</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object]"> record.eventSourceARN })</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object],[object Object],[object Object]">        ReceiptHandle: record.receiptHandle</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object]">      }).</span><span style="color:#50FA7B;" class="[object Object]">promise</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">()</span></div><div class="line"></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">      </span><span style="color:#FF79C6;" class="[object Object]">return</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> messageResult</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]">  })</span></div><div class="line"></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#FF79C6;" class="[object Object]">const</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]"> processedMessages </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">await</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">Promise</span><span style="color:#F8F8F2;" class="[object Object]">.</span><span style="color:#50FA7B;" class="[object Object]">allSettled</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]">(messageProcessingPromises)</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#FF79C6;" class="[object Object]">const</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]"> failedMessages </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]"> processedMessages.</span><span style="color:#50FA7B;" class="[object Object]">filter</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">((</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">r</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">) </span><span style="color:#FF79C6;" class="[object Object]">=&gt;</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object],[object Object]"> r.status </span><span style="color:#FF79C6;" class="[object Object]">===</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#E9F284;" class="[object Object]">'</span><span style="color:#F1FA8C;" class="[object Object]">rejected</span><span style="color:#E9F284;" class="[object Object]">'</span><span style="color:#F8F8F2;" class="[object Object]">)</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#6272A4;" class="[object Object],[object Object]">// At least one message failed to be processed; throw an error to keep the failed messages on the queue</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#FF79C6;" class="[object Object]">if</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object]"> (failedMessages.length) </span><span style="color:#FF79C6;" class="[object Object]">throw</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;font-weight:bold;" class="[object Object]">new</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">Error</span><span style="color:#F8F8F2;" class="[object Object]">(</span><span style="color:#E9F284;" class="[object Object]">'</span><span style="color:#F1FA8C;" class="[object Object]">Partial batch failure</span><span style="color:#E9F284;" class="[object Object]">'</span><span style="color:#F8F8F2;" class="[object Object]">)</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#6272A4;" class="[object Object],[object Object]">// All messages were processed successfully</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#FF79C6;" class="[object Object]">return</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#BD93F9;" class="[object Object]">null</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">}</span></div><div class="line"></div><div class="line"><span style="color:#FF79C6;" class="[object Object]">async</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#FF79C6;" class="[object Object]">function</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#50FA7B;" class="[object Object]">processMessage</span><span style="color:#F8F8F2;" class="[object Object]">(</span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">record</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]">) {</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#FF79C6;" class="[object Object]">...</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">}</span></div><div class="line"></div><div class="line"><span style="color:#FF79C6;" class="[object Object]">function</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#50FA7B;" class="[object Object]">getQueueUrl</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object]"> ({ </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">sqs</span><span style="color:#F8F8F2;" class="[object Object],[object Object]">, </span><span style="color:#FFB86C;font-style:italic;" class="[object Object]">eventSourceARN</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object],[object Object]"> }) {</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#FF79C6;" class="[object Object]">const</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object]"> [, , , , accountId, queueName] </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]"> eventSourceARN.</span><span style="color:#50FA7B;" class="[object Object]">split</span><span style="color:#F8F8F2;" class="[object Object]">(</span><span style="color:#E9F284;" class="[object Object]">'</span><span style="color:#F1FA8C;" class="[object Object]">:</span><span style="color:#E9F284;" class="[object Object]">'</span><span style="color:#F8F8F2;" class="[object Object]">)</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">  </span><span style="color:#FF79C6;" class="[object Object]">return</span><span style="color:#F8F8F2;" class="[object Object]"> </span><span style="color:#F1FA8C;" class="[object Object]">`</span><span style="color:#FF79C6;" class="[object Object]">${</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object],[object Object],[object Object]">sqs.endpoint.href</span><span style="color:#FF79C6;" class="[object Object],[object Object]">}${</span><span style="color:#F8F8F2;" class="[object Object]">accountId</span><span style="color:#FF79C6;" class="[object Object]">}</span><span style="color:#F1FA8C;" class="[object Object]">/</span><span style="color:#FF79C6;" class="[object Object]">${</span><span style="color:#F8F8F2;" class="[object Object]">queueName</span><span style="color:#FF79C6;" class="[object Object]">}</span><span style="color:#F1FA8C;" class="[object Object]">`</span></div><div class="line"><span style="color:#F8F8F2;" class="[object Object]">}</span></div><div class="line"></div><div class="line"><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">module</span><span style="color:#F8F8F2;" class="[object Object]">.</span><span style="color:#8BE9FD;font-style:italic;" class="[object Object]">exports</span><span style="color:#F8F8F2;" class="[object Object],[object Object],[object Object]">.handler </span><span style="color:#FF79C6;" class="[object Object]">=</span><span style="color:#F8F8F2;" class="[object Object],[object Object]"> handler</span></div></code></pre><button class="markdown-it-code-copy" data-clipboard-text="
	const SQS = require(<SINGLE-QUOTE>aws-sdk/clients/sqs<SINGLE-QUOTE>)
const sqs = new SQS()

async function handler (event) {
  const messageProcessingPromises = event.Records.map(async (record, index) => {
      const messageResult = await processMessage(record)
      await sqs.deleteMessage({
        QueueUrl: getQueueUrl({ sqs, eventSourceARN: record.eventSourceARN })
        ReceiptHandle: record.receiptHandle
      }).promise()

      return messageResult
  })

  const processedMessages = await Promise.allSettled(messageProcessingPromises)
  const failedMessages = processedMessages.filter((r) => r.status === <SINGLE-QUOTE>rejected<SINGLE-QUOTE>)
  // At least one message failed to be processed; throw an error to keep the failed messages on the queue
  if (failedMessages.length) throw new Error(<SINGLE-QUOTE>Partial batch failure<SINGLE-QUOTE>)
  
  // All messages were processed successfully
  return null
}

async function processMessage(record) {
  ...
}

function getQueueUrl ({ sqs, eventSourceARN }) {
  const [, , , , accountId, queueName] = eventSourceARN.split(<SINGLE-QUOTE>:<SINGLE-QUOTE>)
  return `${sqs.endpoint.href}${accountId}/${queueName}`
}

module.exports.handler = handler
" style="position:absolute;top:7.5px;right:6px;cursor:pointer;outline:none;" title="Copy"><span style="" class="heroicon heroicon-duplicate"></span></button></div><p><span class="emoji-wrapper"><span class="native-emoji">In this example here we are going to process each message and delete that message from the queue. The onces that were rejected, were never deleted. And then when we throw the error, the retry will only effect the messages that have not yet been deleted.</span> In this example here we are going to process each message and delete that message from the queue. The onces that were rejected, were never deleted. And then when we throw the error, the retry will only effect the messages that have not yet been deleted. </span></p><h2 id="what-is-a-dead-letter-queue" tabindex="-1"><a class="header-anchor" href="#what-is-a-dead-letter-queue" aria-hidden="true">#</a><span class="emoji-wrapper"><span class="native-emoji"></span></span><span class="emoji-wrapper"><span class="native-emoji">What is a Dead Letter Queue</span> What is a Dead Letter Queue </span></h2><p><span class="emoji-wrapper"><span class="native-emoji">The dead letter queue is a queue that is used to store messages that failed to be processed. This is a queue that is configured to be a dead letter queue.</span> The dead letter queue is a queue that is used to store messages that failed to be processed. This is a queue that is configured to be a dead letter queue. </span></p></div><!--]--></div></div></div></div></div>
    
    <script>
      /* Check prefere color scheme **/
      (function() {
        // Current themes are 🐧, 🧛🏻‍♂️, 🐺
        document.documentElement.classList.add(
          localStorage.getItem('theme') || '🧛🏻‍♂️',
        ) // Default theme is dracula
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        const setting = localStorage.getItem('color-schema') || 'auto'
        if (setting === 'dark' || (prefersDark && setting !== 'light'))
          document.documentElement.classList.toggle('dark', true)
      })()
    </script>
  

<link rel="stylesheet" href="/assets/app.918e7b3f.css"></body></html>